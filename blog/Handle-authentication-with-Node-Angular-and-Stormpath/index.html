<!DOCTYPE html><html lang="en" prefix="og: http://ogp.me/ns#"><head><meta name="generator" content="Hexo 3.8.0"><meta name="author" content="Connor Leech"><title>Handle authentication with Node, Angular and Stormpath</title><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta http-equiv="cleartype" content="on"><meta name="MobileOptimized" content="320"><meta name="HandheldFriendly" content="True"><meta name="apple-mobile-web-app-capable" content="yes"><meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=no"><meta name="description" content="In this tutorial we use Stormpath managed authentication service provider to handle authentication for our Node.js powered app. Stormpath has since been acquired by Okta and their API is shutting down soon. Pour one out for the homies.."><meta name="keywords" content="laravel, aws, javascript, php, developer, software engineer, web development, software, node.js, serverless, lambda, san francisco, bay area, east bay, vue, vuejs, vue.js, vue 2, laravel 5, amazon web services"><meta name="zipcode" content="94501"><meta name="city" content="Alameda"><meta name="state" content="California"><meta name="country" content="United States"><meta name="language" content="EN"><meta property="og:site_name" content="Connor Leech Blog | Javascript and Laravel tutorials"><meta property="og:description" content="Get notified about the latest trends in web development, career growth and cloud infrastructure. I send emails about twice a month covering tutorials in Javascript, Laravel and Cloud"><meta property="og:image" content="http://i0.kym-cdn.com/photos/images/original/001/018/899/936.jpg"><meta property="og:title" content="Handle authentication with Node, Angular and Stormpath"><meta property="og:description" content="In this tutorial we use Stormpath managed authentication service provider to handle authentication for our Node.js powered app. Stormpath has since been acquired by Okta and their API is shutting down soon. Pour one out for the homies.."><!-- Global site tag (gtag.js) - Google Analytics -->
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-70809574-1"></script><script>window.dataLayer = window.dataLayer || [];
function gtag(){dataLayer.push(arguments);}
gtag('js', new Date());

gtag('config', 'UA-70809574-1');
</script><!-- Favicon--><link rel="shortcut icon" type="image/png" href="/images/favicon.ico"><link rel="icon" type="image/png" sizes="32x32" href="/images/favicon-32x32.png"><link rel="icon" type="image/png" sizes="96x96" href="/images/favicon-96x96.png"><link rel="icon" type="image/png" sizes="16x16" href="/images/favicon-16x16.png"><!-- Vendor Fonts--><link href="https://maxcdn.bootstrapcdn.com/font-awesome/4.6.1/css/font-awesome.min.css" rel="stylesheet" type="text/css"><link href="/bower_components/animate.css/animate.min.css" rel="stylesheet" type="text/css"><link href="https://fonts.googleapis.com/css?family=Yantramanav" rel="stylesheet"><!-- HTML5 Shim and Respond.js IE8 support of HTML5 elements and media queries--><!-- WARNING: Respond.js doesn't work if you view the page via file://--><!--if lt IE 9script(src='https://oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js')
script(src='https://oss.maxcdn.com/libs/respond.js/1.4.2/respond.min.js')
--><link rel="alternate" href="/atom.xml" title="config.title" type="application/rss2.xml"><link rel="stylesheet" href="/css/main.css"></head><body id="page-top" data-spy="scroll" data-target=".navbar-fixed-top" class="post"><!-- Nav--><nav role="navigation" class="navbar navbar-custom navbar-fixed-top"><div class="container"><div class="navbar-header"><a href="https://employbl.com/" target="_blank" class="navbar-brand"><img src="/images/employbl_logo.svg" style="height:100px; width:100px;"></a><button type="button" data-toggle="collapse" data-target=".navbar-main-collapse" class="navbar-toggle"><i class="fa fa-bars"></i></button></div><div class="collapse navbar-collapse navbar-left navbar-main-collapse"></div><div class="collapse navbar-collapse navbar-right navbar-main-collapse"><ul class="nav navbar-nav"><li><a href="/blog" class="page-scroll">Blog üî®</a></li><li><a href="/#about" class="page-scroll">Projects ‚ö°</a></li></ul></div></div></nav><main id="content"><div id="archive" class="container"><div class="row"> <div class="col-sm-2 col-md-2"><h3>Categories</h3><a href="/blog"><p>All</p></a><a href="/categories/Career"><p>Career</p></a><a href="/categories/Programming"><p>Programming</p></a><a href="/categories/Javascript"><p>Javascript</p></a><a href="/categories/Laravel"><p>Laravel</p></a><a href="/categories/Cloud"><p>Cloud</p></a><a href="/categories/PHP"><p>PHP</p></a></div><div class="col-xs-12 col-md-8"><article class="post"><div class="row"><div class="col-md-10 col-md-offset-1"><h1 class="post-title">Handle authentication with Node, Angular and Stormpath</h1></div></div><div class="row"><div class="post-meta"><h5><span>Connor Leech</span><span class="date"> - Nov 30, 2015&ensp;in<span class="post-categories">&ensp;<a href="/categories/Javascript/" class="post-category">Javascript</a></span></span></h5><a target="_blank" href="http://twitter.com/intent/tweet?status=Handle authentication with Node, Angular and Stormpath by @Connor11528+http://connorleech.info/blog/Handle-authentication-with-Node-Angular-and-Stormpath/" class="btn btn-primary social-share twitter"><i class="fa fa-twitter fa-2x"><span class="hidden-xs"></span></i></a><a target="_blank" href="http://www.linkedin.com/shareArticle?mini=true&amp;url=http://connorleech.info/blog/Handle-authentication-with-Node-Angular-and-Stormpath/&amp;title=Handle authentication with Node, Angular and Stormpath&amp;source=connorleech.info" class="btn btn-primary social-share linkedin"><i class="fa fa-linkedin fa-2x"><span class="hidden-xs"></span></i></a></div></div><div class="post-body"><p>Final <a href="https://github.com/connor11528/node-angular-stormpath" target="_blank" rel="noopener">SOURCE CODE</a></p>
<h2 id="Set-up-project"><a href="#Set-up-project" class="headerlink" title="Set up project"></a>Set up project</h2><p>Stormpath is a service that handles user authentication and authorization for you. We are going to integrate Stormpath user management into a very lightweight MEAN stack starter template. First we‚Äôre going to clone the starter project which you can view <a href="https://github.com/connor11528/mean-starter" target="_blank" rel="noopener">here</a>.</p>
<figure class="highlight crmsh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ git <span class="keyword">clone</span> <span class="title">git</span>@github.com:connor11528/mean-starter.git <span class="keyword">node</span><span class="title">-angular-stormpath</span></span><br></pre></td></tr></table></figure>
<p>This command clones the starter template into a folder named ‚Äúnode-angular-stormpath‚Äù. The starter template is set up with MongoDB, so open a new tab and run <code>mongod</code> in that window so MongoDB is ready on your machine.</p>
<p>Next up install dependencies and start the Node.js server.</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">$</span><span class="bash"> <span class="built_in">cd</span> node-angular-stormpath</span></span><br><span class="line"><span class="meta">$</span><span class="bash"> npm i &amp;&amp; nodemon server</span></span><br></pre></td></tr></table></figure>
<h2 id="Register-for-Stormpath"><a href="#Register-for-Stormpath" class="headerlink" title="Register for Stormpath"></a>Register for Stormpath</h2><p>So here I‚Äôm following parts of the <a href="https://stormpath.com/blog/angular-node-15-minutes/" target="_blank" rel="noopener">official tutorial</a>.</p>
<p>Either <a href="https://api.stormpath.com/register" target="_blank" rel="noopener">register</a> for a new account or <a href="https://api.stormpath.com/login" target="_blank" rel="noopener">login</a> if you already have one. The dashboard will look like this. Click ‚ÄúCreate API Key‚Äù.</p>
<p><img src="http://i.imgur.com/SSnbmVQ.png" alt="Stormpath dashboard"></p>
<p>So once you create a new API key you must download a file with your credentials. This is the message from Stormpath</p>
<blockquote>
<p>By creating a new API Key, you will be prompted to download a file containing both your API Key ID, and the secret key</p>
</blockquote>
<blockquote>
<p>Make sure you place this file in a safe location so you do not lose it. You will not be able to download this file again. If you lose the file, you will have to delete the API key and create a new one.</p>
</blockquote>
<p>I saved the file to my desktop. Next up go to the ‚ÄúApplications‚Äù tab and click ‚ÄúCreate Application‚Äù.</p>
<p><img src="http://i.imgur.com/js1Xx9v.png" alt="Create an application"></p>
<p>Click the application you created from the list and get the ‚ÄúHREF‚Äù. Next configure environment variables on your machine:</p>
<figure class="highlight routeros"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">$ <span class="builtin-name">export</span> <span class="attribute">STORMPATH_CLIENT_APIKEY_ID</span>=xxxx</span><br><span class="line">$ <span class="builtin-name">export</span> <span class="attribute">STORMPATH_CLIENT_APIKEY_SECRET</span>=xxxx</span><br><span class="line">$ <span class="builtin-name">export</span> <span class="attribute">STORMPATH_APPLICATION_HREF</span>=xxxx</span><br></pre></td></tr></table></figure>
<p>To view your environment variables on mac you can use <code>$ printenv</code> or <code>$ printenv STORMPATH_CLIENT_APIKEY_ID</code>. </p>
<p>We will have to do this again when shipping to production, though that will look a bit different. Configuring environment variables on heroku looks like <code>$ heroku config:set STORMPATH_CLIENT_APIKEY_ID=xxxx</code>.</p>
<p>Last but not least you must set a ‚Äúdefault account store‚Äù in order to avoid <a href="https://github.com/stormpath/express-stormpath/issues/212" target="_blank" rel="noopener">this error</a>.</p>
<p><img src="http://i.imgur.com/VN1tFsl.png" alt="Set a default account store"></p>
<h2 id="Start-coding"><a href="#Start-coding" class="headerlink" title="Start coding"></a>Start coding</h2><p>After we set up Stormpath for our environment install the stormpath npm package into our project:</p>
<figure class="highlight maxima"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ npm i --<span class="built_in">save</span> <span class="built_in">express</span>-stormpath</span><br></pre></td></tr></table></figure>
<p>Then init the stormpath in <strong>server.js</strong> after the express config block:</p>
<figure class="highlight lasso"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// STORMPATH CONFIG</span></span><br><span class="line"><span class="built_in">var</span> stormpath = <span class="keyword">require</span>(<span class="string">'express-stormpath'</span>);</span><br><span class="line"><span class="built_in">var</span> path = <span class="keyword">require</span>(<span class="string">'path'</span>);</span><br><span class="line"></span><br><span class="line">app.use(stormpath.init(app, &#123;</span><br><span class="line">	website: <span class="literal">true</span>,</span><br><span class="line">	web: &#123;</span><br><span class="line">		spaRoot: path.<span class="keyword">join</span>(__dirname, <span class="string">'public'</span>, <span class="string">'index.html'</span>)</span><br><span class="line">	&#125;</span><br><span class="line">&#125;));</span><br></pre></td></tr></table></figure>
<h2 id="Protect-a-route"><a href="#Protect-a-route" class="headerlink" title="Protect a route"></a>Protect a route</h2><p>Go into <strong>server/routes.js</strong> and add some API routes.</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">module</span>.exports = <span class="function"><span class="keyword">function</span>(<span class="params">app</span>)</span>&#123;	</span><br><span class="line"></span><br><span class="line">	apiRouter.get(<span class="string">'/test'</span>, stormpath.apiAuthenticationRequired, <span class="function"><span class="keyword">function</span>(<span class="params">req, res</span>)</span>&#123;</span><br><span class="line">		res.send(<span class="string">'Does not pass the test!'</span>);</span><br><span class="line">	&#125;);</span><br><span class="line"></span><br><span class="line">	apiRouter.get(<span class="string">'/test2'</span>, <span class="function"><span class="keyword">function</span>(<span class="params">req, res</span>)</span>&#123;</span><br><span class="line">		res.send(<span class="string">'Passes the test!'</span>);</span><br><span class="line">	&#125;);</span><br><span class="line">	</span><br><span class="line">	...</span><br></pre></td></tr></table></figure>
<p>When you try to hit <code>http://localhost:3000/api/test</code> you will get a JSON error:</p>
<figure class="highlight subunit"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">&#123;</span><br><span class="line"><span class="keyword">error: </span>"Invalid API credentials."</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>But when you go to <code>http://localhost:3000/api/test2</code> you will see the text ‚ÄúPasses the test!‚Äù. Just like that we have endpoint protection for our API.</p>
<h2 id="Log-users-in"><a href="#Log-users-in" class="headerlink" title="Log users in"></a>Log users in</h2><p>Now we will transition to client side. We are going to use bower. It should really be part of the starter template but whatever, here it goes:</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">$</span><span class="bash"> touch .bowerrc</span></span><br></pre></td></tr></table></figure>
<p><strong>.bowerrc</strong> then looks like:</p>
<figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">&#123;</span><br><span class="line">  <span class="attr">"directory"</span>: <span class="string">"public/bower_components"</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>Then run our bower commands:</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">$</span><span class="bash"> bower init</span></span><br><span class="line"><span class="meta">$</span><span class="bash"> bower install --save stormpath-sdk-angularjs</span></span><br></pre></td></tr></table></figure>
<p>Add these scripts to index.html:</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">script</span> <span class="attr">src</span>=<span class="string">"bower_components/stormpath-sdk-angularjs/dist/stormpath-sdk-angularjs.js"</span>&gt;</span><span class="undefined"></span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">script</span> <span class="attr">src</span>=<span class="string">"bower_components/stormpath-sdk-angularjs/dist/stormpath-sdk-angularjs.tpls.js"</span>&gt;</span><span class="undefined"></span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br></pre></td></tr></table></figure>
<p>And add the modules to our angular app:</p>
<figure class="highlight sml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">var app = angular.module(<span class="symbol">'mean</span>-boilerplate', [</span><br><span class="line">	<span class="symbol">'ui</span>.router',</span><br><span class="line">	<span class="symbol">'stormpath'</span>,</span><br><span class="line">	<span class="symbol">'stormpath</span>.templates'</span><br><span class="line">]);</span><br></pre></td></tr></table></figure>
<p>Then configure the <code>$stormpath</code> module in a run block:</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">app.run(<span class="function"><span class="keyword">function</span><span class="params">($stormpath)</span></span>&#123;</span><br><span class="line">  $stormpath.uiRouter(&#123;</span><br><span class="line">    loginState: <span class="string">'login'</span>,</span><br><span class="line">    defaultPostLoginState: <span class="string">'main'</span></span><br><span class="line">  &#125;);</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure>
<p>This sends users to the ‚Äúmain‚Äù view after they log in and to the ‚Äúlogin‚Äù view if they try and access a protected route when not logged in.</p>
<p>Create a navbar in <strong>public/templates/navbar.html</strong>:</p>
<figure class="highlight dust"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="xml"><span class="tag">&lt;<span class="name">ul</span> <span class="attr">class</span>=<span class="string">"nav navbar-nav"</span>&gt;</span></span></span><br><span class="line"><span class="xml">  <span class="tag">&lt;<span class="name">li</span> <span class="attr">ng-repeat</span>=<span class="string">"item in menu"</span> <span class="attr">ng-class</span>=<span class="string">"</span></span></span><span class="template-variable">&#123;active: isActive(item.link)&#125;</span><span class="xml"><span class="tag"><span class="string">"</span>&gt;</span></span></span><br><span class="line"><span class="xml">      <span class="tag">&lt;<span class="name">a</span> <span class="attr">ng-href</span>=<span class="string">"</span></span></span><span class="template-variable">&#123;&#123;item.link&#125;</span><span class="xml"><span class="tag"><span class="string">&#125;"</span>&gt;</span></span><span class="template-variable">&#123;&#123;item.title&#125;</span><span class="xml">&#125;<span class="tag">&lt;/<span class="name">a</span>&gt;</span></span></span><br><span class="line"><span class="xml">  <span class="tag">&lt;/<span class="name">li</span>&gt;</span></span></span><br><span class="line"><span class="xml">  <span class="tag">&lt;<span class="name">li</span> <span class="attr">if-user</span> <span class="attr">ng-class</span>=<span class="string">"</span></span></span><span class="template-variable">&#123;active: isActive('/profile')&#125;</span><span class="xml"><span class="tag"><span class="string">"</span>&gt;</span></span></span><br><span class="line"><span class="xml">      <span class="tag">&lt;<span class="name">a</span> <span class="attr">ng-href</span>=<span class="string">"/profile"</span>&gt;</span>Profile<span class="tag">&lt;/<span class="name">a</span>&gt;</span></span></span><br><span class="line"><span class="xml">  <span class="tag">&lt;/<span class="name">li</span>&gt;</span></span></span><br><span class="line"><span class="xml">  <span class="tag">&lt;<span class="name">li</span> <span class="attr">if-not-user</span> <span class="attr">ng-class</span>=<span class="string">"</span></span></span><span class="template-variable">&#123;active: isActive('/register')&#125;</span><span class="xml"><span class="tag"><span class="string">"</span>&gt;</span></span></span><br><span class="line"><span class="xml">      <span class="tag">&lt;<span class="name">a</span> <span class="attr">ui-sref</span>=<span class="string">"register"</span>&gt;</span>Register<span class="tag">&lt;/<span class="name">a</span>&gt;</span></span></span><br><span class="line"><span class="xml">  <span class="tag">&lt;/<span class="name">li</span>&gt;</span></span></span><br><span class="line"><span class="xml">  <span class="tag">&lt;<span class="name">li</span> <span class="attr">if-not-user</span> <span class="attr">ng-class</span>=<span class="string">"</span></span></span><span class="template-variable">&#123;active: isActive('/login')&#125;</span><span class="xml"><span class="tag"><span class="string">"</span>&gt;</span></span></span><br><span class="line"><span class="xml">      <span class="tag">&lt;<span class="name">a</span> <span class="attr">ui-sref</span>=<span class="string">"login"</span>&gt;</span>Login<span class="tag">&lt;/<span class="name">a</span>&gt;</span></span></span><br><span class="line"><span class="xml">  <span class="tag">&lt;/<span class="name">li</span>&gt;</span></span></span><br><span class="line"><span class="xml">  <span class="tag">&lt;<span class="name">li</span> <span class="attr">if-user</span> <span class="attr">ng-class</span>=<span class="string">"</span></span></span><span class="template-variable">&#123;active: isActive('/logout')&#125;</span><span class="xml"><span class="tag"><span class="string">"</span>&gt;</span></span></span><br><span class="line"><span class="xml">      <span class="tag">&lt;<span class="name">a</span> <span class="attr">ui-sref</span>=<span class="string">"main"</span> <span class="attr">logout</span>&gt;</span>Logout<span class="tag">&lt;/<span class="name">a</span>&gt;</span></span></span><br><span class="line"><span class="xml">  <span class="tag">&lt;/<span class="name">li</span>&gt;</span></span></span><br><span class="line"><span class="xml"><span class="tag">&lt;/<span class="name">ul</span>&gt;</span></span></span><br></pre></td></tr></table></figure>
<p>Then add the navbar to <strong>public/index.html</strong>:</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">&lt;div <span class="class"><span class="keyword">class</span></span>=<span class="string">'container'</span>&gt;</span><br><span class="line">   &lt;div ng-include=<span class="string">"'templates/navbar.html'"</span>&gt;<span class="xml"><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></span><br><span class="line">   &lt;div ui-view&gt;<span class="xml"><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></span><br><span class="line">&lt;<span class="regexp">/div&gt;</span></span><br></pre></td></tr></table></figure>
<p>Define routes: </p>
<figure class="highlight pf"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="variable">$stateProvider</span></span><br><span class="line">	.<span class="keyword">state</span>('main', &#123;</span><br><span class="line">		url: <span class="string">"/"</span>,</span><br><span class="line">		templateUrl: <span class="string">"templates/main.html"</span>,</span><br><span class="line">		controller: 'MainCtrl'</span><br><span class="line">	&#125;)</span><br><span class="line">	.<span class="keyword">state</span>('register', &#123;</span><br><span class="line">		url: <span class="string">"/register"</span>,</span><br><span class="line">		templateUrl: <span class="string">"templates/register.html"</span>,</span><br><span class="line">	&#125;)</span><br><span class="line">	.<span class="keyword">state</span>('login', &#123;</span><br><span class="line">		url: <span class="string">"/login"</span>,</span><br><span class="line">		templateUrl: <span class="string">"templates/login.html"</span>,</span><br><span class="line">	&#125;);</span><br></pre></td></tr></table></figure>
<p>Create the register and login templates.</p>
<p><strong>public/templates/register.html</strong></p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">&lt;div <span class="class"><span class="keyword">class</span></span>=<span class="string">"row"</span>&gt;</span><br><span class="line">	&lt;div <span class="class"><span class="keyword">class</span></span>=<span class="string">"col-xs-12"</span>&gt;</span><br><span class="line">	  &lt;h3&gt;Registration&lt;<span class="regexp">/h3&gt;</span></span><br><span class="line"><span class="regexp">	  &lt;hr&gt;</span></span><br><span class="line"><span class="regexp">	&lt;/</span>div&gt;</span><br><span class="line">&lt;<span class="regexp">/div&gt;</span></span><br><span class="line"><span class="regexp">&lt;div sp-registration-form post-login-state="main"&gt;&lt;/</span>div&gt;</span><br></pre></td></tr></table></figure>
<p><strong>public/templates/login.html</strong></p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">&lt;div <span class="class"><span class="keyword">class</span></span>=<span class="string">"row"</span>&gt;</span><br><span class="line">	&lt;div <span class="class"><span class="keyword">class</span></span>=<span class="string">"col-xs-12"</span>&gt;</span><br><span class="line">	  &lt;h3&gt;Login&lt;<span class="regexp">/h3&gt;</span></span><br><span class="line"><span class="regexp">	  &lt;hr&gt;</span></span><br><span class="line"><span class="regexp">	&lt;/</span>div&gt;</span><br><span class="line">&lt;<span class="regexp">/div&gt;</span></span><br><span class="line"><span class="regexp">&lt;div sp-login-form&gt;&lt;/</span>div&gt;</span><br></pre></td></tr></table></figure>
<p>The Stormpath angular library gives us special directives for our login and registration forms.</p>
<h2 id="Create-profile-view"><a href="#Create-profile-view" class="headerlink" title="Create profile view"></a>Create profile view</h2><p>Next we will create a profile view and force the user to log in in order to view it. The route looks like:</p>
<figure class="highlight less"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="selector-class">.state</span>(<span class="string">'profile'</span>, &#123;</span><br><span class="line">  <span class="attribute">url</span>: <span class="string">'/profile'</span>,</span><br><span class="line">  <span class="attribute">templateUrl</span>: <span class="string">'templates/profile.html'</span>,</span><br><span class="line">  <span class="attribute">sp</span>: &#123;</span><br><span class="line">    <span class="attribute">authenticate</span>: true</span><br><span class="line">  &#125;</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure>
<p>and the template looks like:</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">&lt;div <span class="class"><span class="keyword">class</span></span>=<span class="string">"row"</span>&gt;</span><br><span class="line">  &lt;div <span class="class"><span class="keyword">class</span></span>=<span class="string">"col-xs-12"</span>&gt;</span><br><span class="line">    &lt;h3&gt;My Profile&lt;<span class="regexp">/h3&gt;</span></span><br><span class="line"><span class="regexp">    &lt;hr&gt;</span></span><br><span class="line"><span class="regexp">  &lt;/</span>div&gt;</span><br><span class="line">&lt;<span class="regexp">/div&gt;</span></span><br><span class="line"><span class="regexp"></span></span><br><span class="line"><span class="regexp">&lt;div class="row"&gt;</span></span><br><span class="line"><span class="regexp">  &lt;div class="col-xs-12"&gt;</span></span><br><span class="line"><span class="regexp">    &lt;pre ng-bind="user | json"&gt;&lt;/</span>pre&gt;</span><br><span class="line">  &lt;<span class="regexp">/div&gt;</span></span><br><span class="line"><span class="regexp">&lt;/</span>div&gt;</span><br></pre></td></tr></table></figure>
<p>Here are the <a href="https://github.com/stormpath/stormpath-sdk-angularjs" target="_blank" rel="noopener">stormpath-angularjs</a> docs. Happy building!</p>
<p>Final <a href="https://github.com/connor11528/node-angular-stormpath" target="_blank" rel="noopener">SOURCE CODE</a></p>
</div><div id="disqus_thread"></div></article><nav class="pagination"><a href="/blog/Ruby On Rails‚Ääfor the MEAN stack developer/" title="Ruby On Rails‚Ääfor the MEAN stack developer" class="btn-default entry-pagination__link entry-pagination__link--prev">Prev</a><a href="/blog/5-Steps-in-the-Sales-Process/" title="5 Steps in the Sales Process" class="btn-default entry-pagination__link entry-pagination__link--next">Next</a></nav></div></div></div></main><footer class="footer"><div class="container"><div class="row"><div class="col-sm-6"><h4>Connor's Dev Newsletter</h4><p>Very occassional updates. You're free to sign up.</p><ul><li><form action="//herokuapp.us14.list-manage.com/subscribe/post?u=42dd73a709fbadb4a29ef1d0d&amp;amp;id=b77fdad58d" method="post" id="mc-embedded-subscribe-form" name="mc-embedded-subscribe-form" target="_blank" novalidate="" class="validate"><div class="input-group"><input type="email" value="" name="EMAIL" id="mce-EMAIL" placeholder="Enter your email here" class="required email form-control input-lg"><div id="mce-error-response" style="display:none" class="response"></div><div id="mce-success-response" style="display:none" class="response"></div><div style="position: absolute; left: -5000px;" aria-hidden="true"><input type="text" name="b_42dd73a709fbadb4a29ef1d0d_b77fdad58d" tabindex="-1" value=""></div><span class="input-group-btn"><input type="submit" value="Subscribe" name="subscribe" id="mc-embedded-subscribe" class="btn btn-primary btn-lg"></span></div></form></li></ul></div><div class="col-sm-2 col-sm-offset-1"><h4>Connect</h4><ul><li> <a target="_blank" href="https://github.com/connor11528">GitHub</a></li><li> <a target="_blank" href="https://www.linkedin.com/in/connorleech">LinkedIn</a></li><li> <a target="_blank" href="https://twitter.com/connor11528">Twitter</a></li><li><a target="_blank" href="https://medium.com/@connorleech">Medium</a></li><li><a target="_blank" href="https://stackoverflow.com/users/2031033/connor-leech">Stackoverflow</a></li><li><a target="_blank" href="https://plus.google.com/u/0/+ConnorLeech">Google+</a></li></ul></div><div class="col-sm-3"><h4>Email</h4><ul><li> <a href="mailto:connorleech@gmail.com">connorleech@gmail.com</a></li></ul></div></div></div></footer><!-- vendor--><script src="/bower_components/jquery/dist/jquery.min.js"></script><script src="/bower_components/bootstrap/dist/js/bootstrap.min.js"></script><script src="/bower_components/wow/dist/wow.min.js"></script><script src="/bower_components/jquery-easing/jquery.easing.min.js"></script><script src="/bower_components/jquery-color/jquery.color.js"></script><script src="/bower_components/scrollmagic/scrollmagic/minified/ScrollMagic.min.js"></script><script src="/bower_components/scrollmagic/scrollmagic/minified/plugins/debug.addIndicators.min.js"></script><script src="/bower_components/vivus/dist/vivus.min.js"></script><!-- require modules--><script src="/js/require.js"></script><script src="/js/app.js"></script><!-- analytics--><!-- disqus--><script>(function() { // DON'T EDIT BELOW THIS LINE
var d = document, s = d.createElement('script');
s.src = 'https://connorleech.disqus.com/embed.js';
s.setAttribute('data-timestamp', +new Date());
(d.head || d.body).appendChild(s);
})();</script></body></html>